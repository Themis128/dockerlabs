#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ§ª Running pre-push checks (lenient mode)..."
echo "ğŸ’¡ Tip: Set SKIP_HOOKS=true to skip, or use --no-verify to bypass"

# Allow skipping with environment variable
if [ "$SKIP_HOOKS" = "true" ] || [ "$HUSKY" = "0" ]; then
  echo "âš ï¸  Skipping pre-push checks (SKIP_HOOKS=true or HUSKY=0)"
  exit 0
fi

# Skip tests if SKIP_TESTS is set
if [ "$SKIP_TESTS" = "true" ]; then
  echo "âš ï¸  Skipping tests (SKIP_TESTS=true)"
  exit 0
fi

# Run Playwright tests (non-blocking in lenient mode)
echo "Running Playwright tests (non-blocking)..."
npm test 2>&1 | tee /tmp/test-output.txt || {
  echo "âš ï¸  Tests failed (non-blocking in lenient mode)"
  echo "ğŸ’¡ Review test failures above, but push will proceed"
  echo "ğŸ’¡ To make tests blocking, remove 'lenient mode' from this hook"
  exit 0
}

echo "âœ… Pre-push checks passed"
exit 0
